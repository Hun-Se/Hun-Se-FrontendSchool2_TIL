<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>

<body>
    <script>
        'use strict';

        //Promise is a JavaScript object for asyncchronous operation.
        //state: pending -> fulfiled or rejecter
        // Producer vs Consumer

        // 1.Producer
        // when new promise is created, the excutor runs automaically.
        const promise = new Promise((resolve, reject) => {
            console.log('doing somthing...');
            setTimeout(() => {
                // resolve('ellie')
                reject(new Error('no network'));
            }, 2000);
        });

        // 2.Consumers: then, catch, finally
        promise
            .then((value) => {
                console.log(value);
            }).catch(error => {
                console.log('error')
            })
            .finally(() => {
                console.log('finally');
            });

            //3. Promise chaning
            const fetchNumber = new Promise((resolve, reject)=>{
                setTimeout(() => resolve(1), 1000);
            });

            fetchNumber
            .then(num => num * 2)
            .then(num => num *3)
            .then(num => {
                return new Promise((resolve, reject) => {
                    setTimeout(() => resolve(num-1), 1000);
                });
            })
            .then(num => console.log(num));

            //4. Error Handling
            const getHen = () =>
            new Promise((resolve, reject) => {
                setTimeout(() => resolve('닭'), 1000);
            })

            const getEgg = hen =>
            {new Promise((resolve, reject) => {})}

            const cook = egg =>
            new Promise((resolve, reject) => {
                setTimeout(() => {resolve(`${egg} => 후라이`),1000});
            })

                getHen ()
                .then(hen => getEgg(hen))
                .then(egg => cook(egg))
                .then(meal => console.log(meal));

                getHen()
                .then(getEgg)
                .catch(error => {
                    return'빵';
                })
                .then(cook)
                .then(console.log)
                .chatch(console.log);
    </script>
</body>

</html>